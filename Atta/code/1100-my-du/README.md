# 解析目录(递归)

## v1

- 代码文件：
  - [main.c](./v1/main.c)

- 说明：
  - 运行：`./main /etc/dracut.conf`
  - 获取给定目录下所有目录和文件的大小(递归获取, 单位为 KB)

- 知识点:
  - 递归
  - `lstat(2)`
  - `glob(3)`
  - 注意: 若 `glob(3)` 返回值为 `GLOB_NOMATCH` (即: 3), 为没有匹配项,(即: 目录为空或要匹配的文件
    不存在, 正常现象, 为假错误)
  - `globfree(3)`
  - `strncpy(3)` : 不会自动追加尾零, 若字符数组未初始化为全零则需手动追加尾零(定义数组时初始化是个
    好习惯)
  - `strncat(3)` : 会自动追加尾零
  - `strchr(3)` `strrchr(3)`
  - `strcmp(3)`

- 资料：
  - _(LHQ 28.3 28.4)_

## v2

- 代码文件：
  - [main.c](./v2/main.c)

- 说明：
  - 运行：`./main /etc/dracut.conf`
  - 获取给定目录下所有目录和文件的大小(递归获取, 单位为 KB)

- 知识点:
  - 递归的优化
    - 慎用全局变量
    - 若对一个变量的使用只在递归点之前出现或只在递归点之后出现, 那么该变量可以被优化到静态区中去
      存放(甚至是放到全局变量去使用问题也不大(在可能的情况下尽量把全局变量修饰成 static)). 若一个
      变量是跨递归点使用的, 那么该变量就只能以 `auto` 类型存在.

- 资料：
  - _(LHQ 28.4)_
